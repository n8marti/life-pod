#:kivy 2.0
#:import Factory kivy.factory.Factory

<LifePodWin>:
    canvas.before:
        Color:
            rgba: (1, 1, 1, 1)
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        size_hint: (0.25, 0.75)
        pos_hint: {'center_x': 0.25, 'center_y': 0.5}
        PlayerChooser: # radios with player list
            size_hint_y: 0.75
        Label:
            size_hint_y: 0.15
        ResetButton:
            size_hint_y: 0.10

    FloatLayout: # container for full "LIFE Pod"
        size_hint_x: 3/4
        BoxLayout: # center area with screen & buttons
            spacing: 5
            size_hint: 0.5, 0.5
            pos_hint: {'center_x': .5, 'center_y': .5}
            MinusButton:
            BoxLayout: # blue buttons & screen frame
                spacing: 5
                size_hint: 0.6, 1.0
                orientation: 'vertical'
                BlueBoxLayout: # top 3 buttons
                    EnterButton:
                    SpinButton:
                    UndoButton:

                # display screen
                ScreenBoxLayout:
                    orientation: 'vertical'
                    ScreenBoxLayout:  # 1st row of display screen
                        size_hint_y: 1/5
                        ScreenImage:
                            id: house_modest
                            size_hint_x: 1/6
                            source_shown: f"{root.img_dir}/house-modest.png"
                        ScreenImage:
                            id: house_midsized
                            size_hint_x: 1/6
                            source_shown: f"{root.img_dir}/house-midsized.png"
                        ScreenImage:
                            id: house_mansion
                            size_hint_x: 1/6
                            source_shown: f"{root.img_dir}/house-mansion.png"
                        ScreenImage:
                            id: car_economy
                            size_hint_x: 1/6
                            source_shown: f"{root.img_dir}/car-economy.png"
                        ScreenImage:
                            id: car_sports
                            size_hint_x: 1/6
                            source_shown: f"{root.img_dir}/car-sports.png"
                        ScreenImage:  # baby image
                            id: babies
                            size_hint_x: 1/12
                            source_shown: f"{root.img_dir}/babies.png"
                        ScreenLabel:
                            id: baby_count
                            size_hint_x: 1/12
                    ScreenBoxLayout: # 2nd row of display screen
                        size_hint_y: 2/5
                        ScreenImage:
                            size_hint_x: 1/8
                            id: dollar
                            source_shown: f"{root.img_dir}/dollar.png"
                        ScreenLabel:  # used to display messages and dollars
                            size_hint_x: 6/8
                            id: display1
                        ScreenBoxLayout:
                            size_hint_x: 1/8
                            orientation: 'vertical'
                            ScreenImage:  # wedding ring
                                id: married
                                source_shown: f"{root.img_dir}/married.png"
                            ScreenLabel:  # +/-
                                id: sign
                    ScreenBoxLayout: # 3rd row of display screen
                        size_hint_y: 2/5
                        spacing: 10
                        ScreenImage:  # heart
                            size_hint_x: 1/8
                            id: heart
                            source_shown: f"{root.img_dir}/heart.png"
                        ScreenLabel:  # used to echo user input
                            size_hint_x: 6/8
                            id: display2
                        ScreenBoxLayout:
                            size_hint_x: 1/8
                            orientation: 'vertical'
                            ScreenImage: # clock
                                id: turns
                                source_shown: f"{root.img_dir}/clock.png"
                            ScreenLabel:
                                id: remaining_rounds

                BlueBoxLayout: # bottom 2 buttons
                    DollarUnitButton:
                    LifePointsUnitButton:
            PlusButton:

        # Number buttons
        NumLayout:
            number: 0
            text: "SALARY"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 1
            text: "LOTTERY"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 2
            text: "CHANCE"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 3
            text: "MARRIAGE"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 4
            text: ""
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: str(self.parent.text)

        NumLayout:
            number: 5
            text: "HOUSE"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 6
            text: "CAR"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 7
            text: "BABY"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 8
            text: ""
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 9
            text: ""
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text

        NumLayout:
            number: 10
            text: "YEARS"
            pos_hint: self._get_pos_hint()
            NumButtonInset:
                size_hint_y: 2/3
                text: str(self.parent.number)
            AppLabel:
                size_hint_y: 1/3
                text: self.parent.text


<BlueBoxLayout@BoxLayout>:
    size_hint: 1, 0.25
    spacing: 5


<ScreenImage>
    canvas.before:
        Color:
            rgba: (0.6, 0.6, 0.6, 1)
        Rectangle:
            pos: self.pos
            size: self.size
    fit_mode: "contain"


<ScreenBoxLayout@BoxLayout>:
    canvas.before:
        Color:
            rgba: (0.6, 0.6, 0.6, 1)
        Rectangle:
            pos: self.pos
            size: self.size


<AppLabel>:  # used for secondary functions of number buttons
    color: (0, 0, 0, 1)
    font_size: dp(12)
    bold: True

<ScreenLabel@AppLabel>:
    halign: 'right'
    valign: 'middle'
    bold: False
    font_name: 'RobotoMono-Regular'
    font_size: dp(28)
    text_size: (self.width, None)
    shorten: True



<AppButton>:
    color: (0, 0, 0, 1)
    font_size: dp(24)
    bold: True

<BlueButton@AppButton>:
    background_normal: ''
    background_color: (0.2, 0.75, 1, 1)
    font_size: dp(20)

<EnterButton@BlueButton>:
    text: "Enter"
    on_press: app.root.handle_enter()

<SpinButton@BlueButton>:
    text: "Spin"
    on_press: app.root.handle_spin()

<UndoButton@BlueButton>:
    text: "Undo"
    on_press: app.root.handle_undo()

<DollarUnitButton@BlueButton>:
    text: "$"
    on_press: app.root.handle_dollars()

<LifePointsUnitButton@BlueButton>:
    text: "Life Points"
    on_press: app.root.handle_life_points()


<RedButton@AppButton>:
    background_normal: ''
    background_color: (1, 0, 0.2, 1)
    font_size: dp(24)

<RedSquareButton@RedButton>:
    size_hint: 0.1, 0.15
    padding: 5
    pos_hint: {'center_x': .5, 'center_y': .5}

<MinusButton@RedSquareButton>
    text: "-"
    on_press: app.root.handle_minus()

<PlusButton@RedSquareButton>
    text: "+"
    on_press: app.root.handle_plus()


<NumButton>:
    background_normal: ''
    background_color: (0.75, 0.75, 0.75, 1)
    color: (0, 0, 0, 1)
    bold: True
    size_hint: (0.05, 0.08)
    on_press: app.root.handle_num_input(self)

<NumButtonInset@NumButton>:
    size_hint: (1, 0.80)

<NumLayout>:
    orientation: 'vertical'
    size_hint: (0.05, 0.10)


<PlayerLabel@AppLabel>:
    padding: 3
    font_size: dp(24)
    bold: False
    halign: 'left'

<PlayerChooser@BoxLayout>
    orientation: 'vertical'
    spacing: 5
    PlayerLabel:
        font_size:  dp(30)
        text: 'Player'
    PlayerChoiceNone:
    PlayerChoiceRed:
    PlayerChoiceYellow:
    PlayerChoiceGreen:
    PlayerChoiceBlue:


<PlayerRadio@AppCheckBox>:
    group: 'player'
    color: (0.75, 0.75, 0.75, 1)
    size: (dp(15), dp(15))

<PlayerChoiceNone@BoxLayout>
    PlayerRadio:
        name: "none"
        active: True
        on_active: app.root.handle_player_choice(self)
    PlayerNone:

<PlayerChoiceRed@BoxLayout>
    PlayerRadio:
        name: "red"
        on_active: app.root.handle_player_choice(self)
    PlayerRed:

<PlayerChoiceYellow@BoxLayout>
    PlayerRadio:
        name: "yellow"
        on_active: app.root.handle_player_choice(self)
    PlayerYellow:

<PlayerChoiceGreen@BoxLayout>
    PlayerRadio:
        name: "green"
        on_active: app.root.handle_player_choice(self)
    PlayerGreen:

<PlayerChoiceBlue@BoxLayout>
    PlayerRadio:
        name: "blue"
        on_active: app.root.handle_player_choice(self)
    PlayerBlue:

<PlayerNone@PlayerLabel>
    text: "None"

<PlayerRed@PlayerLabel>
    background_color: (1, 0, 0, 1)
    color: self.background_color
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<PlayerYellow@PlayerLabel>
    background_color: (1, 1, 0, 1)
    color: self.background_color
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<PlayerGreen@PlayerLabel>
    background_color: (0, 1, 0, 1)
    color: self.background_color
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<PlayerBlue@PlayerLabel>
    background_color: (0, 0, 1, 1)
    color: self.background_color
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<ResetButton@RedButton>
    text: "Reset game"
    on_release: Factory.ConfirmationPopup().open()

<ConfirmationPopup@Popup>
    title: "Are you sure you want to reset the game?"
    title_size: dp(30)
    size_hint: (1/3, 1/4)
    BoxLayout:
        AppButton:
            text: "No"
            on_release: root.dismiss()
        RedButton:
            text: "Yes"
            on_release: app.root.handle_reset()